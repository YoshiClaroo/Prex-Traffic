<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bot Interactivo</title>
  <style>
    :root {
      --primary: #4285f4;
      --dark: #2d3748;
      --light: #f8f9fa;
    }
    
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background: var(--dark);
      color: var(--light);
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    
    .control-panel {
      background: rgba(0, 0, 0, 0.7);
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 100;
    }
    
    .counter {
      display: flex;
      gap: 20px;
    }
    
    .counter-value {
      font-size: 1.2rem;
      font-weight: bold;
      color: var(--primary);
    }
    
    #webview {
      flex: 1;
      margin-top: 60px;
      border: none;
    }
  </style>
</head>
<body>
  <div class="control-panel">
    <div class="counter">
      <div>
        <div class="counter-value" id="time-left">40</div>
        <div>Segundos</div>
      </div>
    </div>
  </div>
  
  <iframe id="webview" sandbox="allow-scripts allow-same-origin"></iframe>

  <script>
    const webview = document.getElementById('webview');
    const timeLeftEl = document.getElementById('time-left');
    let interactionInterval;
    let timeLeft = 40;

    // Cargar p치gina desde URL
    function loadPage(url) {
      webview.src = url;
      startInteractions();
    }

    // Iniciar interacciones autom치ticas
    function startInteractions() {
      webview.onload = () => {
        // Timer de 40 segundos
        const timer = setInterval(() => {
          timeLeft--;
          timeLeftEl.textContent = timeLeft;
          if(timeLeft <= 0) clearInterval(timer);
        }, 1000);

        // Interacciones cada 3 segundos
        interactionInterval = setInterval(() => {
          try {
            const iframeDoc = webview.contentDocument || webview.contentWindow.document;
            
            // 1. Cerrar popups (busca botones como "X", "Cerrar", "Aceptar")
            closePopups(iframeDoc);
            
            // 2. Scroll autom치tico (alterna entre arriba/abajo)
            autoScroll(iframeDoc);
            
            // 3. Clicks aleatorios en enlaces/botones
            randomClicks(iframeDoc);
            
          } catch(error) {
            console.log("Error en interacciones:", error);
          }
        }, 3000);
      };
    }

    function closePopups(doc) {
      const closeSelectors = [
        'button[aria-label="Close"]',
        '.close-btn', 
        '#popup-close',
        '.modal-close',
        'button:contains("Cerrar")',
        'button:contains("Aceptar")'
      ];
      
      closeSelectors.forEach(selector => {
        const element = doc.querySelector(selector);
        if(element) element.click();
      });
    }

    function autoScroll(doc) {
      const scrollHeight = doc.body.scrollHeight;
      const currentPos = webview.contentWindow.scrollY;
      const windowHeight = webview.clientHeight;
      
      if(currentPos <= 0) {
        // Scroll hacia abajo
        webview.contentWindow.scrollTo({
          top: scrollHeight,
          behavior: 'smooth'
        });
      } else if(currentPos + windowHeight >= scrollHeight - 100) {
        // Scroll hacia arriba
        webview.contentWindow.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      } else {
        // Scroll aleatorio
        webview.contentWindow.scrollBy({
          top: Math.random() > 0.5 ? 200 : -200,
          behavior: 'smooth'
        });
      }
    }

    function randomClicks(doc) {
      const clickableElements = [
        ...doc.querySelectorAll('a'),
        ...doc.querySelectorAll('button'),
        ...doc.querySelectorAll('[onclick]')
      ];
      
      if(clickableElements.length > 0) {
        const randomElement = clickableElements[Math.floor(Math.random() * clickableElements.length)];
        randomElement.click();
      }
    }

    // Detener interacciones
    function stopInteractions() {
      clearInterval(interactionInterval);
    }

    // Iniciar con URL de ejemplo (reemplaza con tu l칩gica)
    loadPage('https://ejemplo.com');
  </script>
</body>
</html>
